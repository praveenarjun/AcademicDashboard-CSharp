@page
@model StudentEnrollmentSystem1.Pages.Student.ProfileModel
@{
    ViewData["Title"] = "Student Profile";
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-12 mb-4">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">Student Profile</h4>
                </div>
                <div class="card-body">
                    @if (!string.IsNullOrEmpty(Model.SuccessMessage))
                    {
                        <div class="alert alert-success">
                            @Model.SuccessMessage
                        </div>
                    }
                    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
                    {
                        <div class="alert alert-danger">
                            @Model.ErrorMessage
                        </div>
                    }

                    <div class="row">
                        <div class="col-md-4">
                            <div class="text-center mb-4">
                                <img src="~/images/profile-placeholder.png" alt="Profile Picture" class="img-fluid rounded-circle" style="width: 150px; height: 150px;">
                                <h5 class="mt-3">@Model.StudentName</h5>
                                <p class="text-muted">@Model.StudentId</p>
                                <p class="badge bg-primary">@Model.Branch</p>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <ul class="nav nav-tabs" id="profileTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="true">Profile</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="password-tab" data-bs-toggle="tab" data-bs-target="#password" type="button" role="tab" aria-controls="password" aria-selected="false">Change Password</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="bank-tab" data-bs-toggle="tab" data-bs-target="#bank" type="button" role="tab" aria-controls="bank" aria-selected="false">Bank Details</button>
                                </li>
                            </ul>
                            <div class="tab-content p-3 border border-top-0 rounded-bottom" id="profileTabsContent">
                                <!-- Profile Information Tab -->
                                <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                                    <form method="post" asp-page-handler="UpdateProfile">
                                        <div class="mb-3">
                                            <label asp-for="StudentName" class="form-label">Full Name</label>
                                            <input asp-for="StudentName" class="form-control" />
                                            <span asp-validation-for="StudentName" class="text-danger"></span>
                                        </div>
                                        <div class="mb-3">
                                            <label asp-for="Email" class="form-label">Email</label>
                                            <input asp-for="Email" class="form-control" />
                                            <span asp-validation-for="Email" class="text-danger"></span>
                                        </div>
                                        <div class="mb-3">
                                            <label asp-for="PhoneNumber" class="form-label">Phone Number</label>
                                            <input asp-for="PhoneNumber" class="form-control" />
                                            <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                                        </div>
                                        <div class="mb-3">
                                            <label asp-for="FatherName" class="form-label">Father's Name</label>
                                            <input asp-for="FatherName" class="form-control" />
                                            <span asp-validation-for="FatherName" class="text-danger"></span>
                                        </div>
                                        <div class="mb-3">
                                            <label asp-for="MotherName" class="form-label">Mother's Name</label>
                                            <input asp-for="MotherName" class="form-control" />
                                            <span asp-validation-for="MotherName" class="text-danger"></span>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Update Profile</button>
                                    </form>
                                </div>

                                <!-- Change Password Tab -->
                                <div class="tab-pane fade" id="password" role="tabpanel" aria-labelledby="password-tab">
                                    <form method="post" asp-page-handler="ChangePassword">
                                        <div class="mb-3">
                                            <label asp-for="CurrentPassword" class="form-label">Current Password</label>
                                            <input asp-for="CurrentPassword" type="password" class="form-control" />
                                            <span asp-validation-for="CurrentPassword" class="text-danger"></span>
                                        </div>
                                        <div class="mb-3">
                                            <label asp-for="NewPassword" class="form-label">New Password</label>
                                            <input asp-for="NewPassword" type="password" class="form-control" />
                                            <span asp-validation-for="NewPassword" class="text-danger"></span>
                                        </div>
                                        <div class="mb-3">
                                            <label asp-for="ConfirmPassword" class="form-label">Confirm New Password</label>
                                            <input asp-for="ConfirmPassword" type="password" class="form-control" />
                                            <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Change Password</button>
                                    </form>
                                </div>

                                <!-- Bank Details Tab -->
                                <div class="tab-pane fade" id="bank" role="tabpanel" aria-labelledby="bank-tab">
                                    <form method="post" asp-page-handler="UpdateBankDetails">
                                        <div class="mb-3">
                                            <label asp-for="BankName" class="form-label">Bank Name</label>
                                            <input asp-for="BankName" class="form-control" />
                                            <span asp-validation-for="BankName" class="text-danger"></span>
                                        </div>
                                        <div class="mb-3">
                                            <label asp-for="AccountNumber" class="form-label">Account Number</label>
                                            <input asp-for="AccountNumber" class="form-control" />
                                            <span asp-validation-for="AccountNumber" class="text-danger"></span>
                                        </div>
                                        <div class="mb-3">
                                            <label asp-for="IFSC" class="form-label">IFSC Code</label>
                                            <input asp-for="IFSC" class="form-control" />
                                            <span asp-validation-for="IFSC" class="text-danger"></span>
                                        </div>
                                        <div class="mb-3">
                                            <label asp-for="AccountHolderName" class="form-label">Account Holder Name</label>
                                            <input asp-for="AccountHolderName" class="form-control" />
                                            <span asp-validation-for="AccountHolderName" class="text-danger"></span>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Update Bank Details</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        // Activate the tab based on URL hash or any server-side indication
        $(document).ready(function () {
            // Check if there's a hash in the URL
            var hash = window.location.hash;
            if (hash) {
                // Activate the tab corresponding to the hash
                $('#profileTabs a[href="' + hash + '"]').tab('show');
            }

            // Update hash when tab is clicked
            $('#profileTabs a').on('click', function (e) {
                window.location.hash = $(this).attr('href');
            });
        });
    </script>
}